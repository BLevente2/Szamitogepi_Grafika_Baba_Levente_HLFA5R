# Cubestacle SDL

**Cubestacle** is a lightweight 3D endless-runner written in portable C99 on top of **SDL2**, **OpenGL 1.x (fixed-function)**, and a minimal set of self-contained utilities. You pilot a red cube sprinting along an infinite ground strip, dodging procedurally generated obstacles and collecting rotating gold coins. Your score is simply the distance traveled—survive longer and you accelerate faster!

**Author**
Baba Levente (Student ID: HLFA5R)
Contact: [babalevi2018@gmail.com](mailto:babalevi2018@gmail.com)

---

## Table of Contents

1. [Build & Run](#build--run)
2. [Assets](#assets)
3. [Project Structure](#project-structure)
4. [OBJ Model Loader](#obj-model-loader)
5. [Controls](#controls)
6. [Gameplay](#gameplay)
7. [Customization](#customization)
8. [Troubleshooting](#troubleshooting)
9. [License](#license)
10. [Credits](#credits)

---

## 1 · Build & Run

### Dependencies

* **SDL2**
* **SDL2\_image**
* **OpenGL** (system or vendor)
* **pkg-config**, **make**, **GCC/Clang** (or MinGW-w64 on Windows)

#### Linux (Debian/Ubuntu)

```bash
sudo apt update
sudo apt install build-essential make pkg-config \
  libsdl2-dev libsdl2-image-dev libgl1-mesa-dev libglu1-mesa-dev
```

#### macOS (Homebrew)

```bash
brew install sdl2 sdl2_image
```

#### Windows (MinGW-w64)

* Download SDL2 & SDL2\_image dev ZIPs from [https://libsdl.org](https://libsdl.org)
* Unpack into your MinGW include/lib directories

### Clone, Build, Run

```bash
git clone https://github.com/your-user/cubestacle-sdl.git
cd cubestacle-sdl
make                # or "mingw32-make" on Windows
# ensure the 'assets' folder is beside the built binary:
./CubestacleSDL     # on Linux/macOS
CubestacleSDL.exe   # on Windows
```

Override compiler or SDL flags as needed:

```bash
make CC=clang \
  SDL_CFLAGS="$(sdl2-config --cflags)" \
  SDL_LDLIBS="$(sdl2-config --libs)"
```

> **Note:** After building, the `assets/` directory **must** reside alongside the executable so that models and textures load correctly.

---

## 2 · Assets

```
assets/
├── models/
│   └── coin.obj       # Wavefront OBJ model for the rotating coin
└── textures/
    └── ground.bmp     # Ground texture (power-of-two BMP, BGRA8888) – generated by ChatGPT
```

---

## 3 · Project Structure

```
├── assets/            # External assets (models + textures)
├── include/           # Public headers
│   ├── app.h
│   ├── camera.h
│   ├── coin.h
│   ├── config.h
│   ├── control.h
│   ├── font.h
│   ├── gameover.h
│   ├── ground.h
│   ├── info.h
│   ├── menu.h
│   ├── obstacle.h
│   ├── physics.h
│   ├── player.h
│   ├── rectangular_prism.h
│   ├── scene.h
│   ├── skybox.h
│   ├── types.h
│   └── utils.h
├── src/               # Implementation files
│   ├── app.c
│   ├── camera.c
│   ├── coin.c
│   ├── control.c
│   ├── font.c
│   ├── gameover.c
│   ├── ground.c
│   ├── info.c
│   ├── main.c
│   ├── menu.c
│   ├── obstacle.c
│   ├── physics.c
│   ├── player.c
│   ├── rectangular_prism.c
│   ├── scene.c
│   ├── skybox.c
│   └── utils.c
├── Makefile           # Build script
└── README.md          # This file
```

---

## 4 · OBJ Model Loader

This project uses a small **OBJ model loader** as a static library. The loader is compiled into the binary (no external GL loaders required). It handles:

* Vertex positions, normals, and UVs
* Simple triangulation
* Material-less models

Ensure the `coin.obj` file in `assets/models/` remains accessible at runtime for the rotating coin.

---

## 5 · Controls

| Action                 | Key / Mouse                  |
| ---------------------- | ---------------------------- |
| Move left  / right     | **A / D**  or  **← / →**     |
| Tilt camera up  / down | **W / S**  or  **↑ / ↓**     |
| Zoom camera            | Mouse wheel                  |
| Return to main menu    | **Esc**                      |
| Quit                   | “Quit” button in menu screen |

---

## 6 · Gameplay

* The cube accelerates until it caps at **40 units/s**.
* **Score** = ⌊cube’s X-coordinate⌋.
* Collision with an obstacle **or** falling off the track ends the run.
* Coins bob vertically; collecting one increments your **coin counter**.
* New obstacles spawn every \~20–25 units; coins every 8–12 units.
* Obstacle colors shift every **150** score to indicate progression.

---

## 7 · Customization

* **Ground Texture:** Swap `assets/textures/ground.bmp` for any power-of-two BMP (e.g. 1024×1024, BGRA8888).
* **Sky Gradient:** Edit the color stops in `src/skybox.c → sky_color()`.
* **Physics & Speeds:** Adjust parameters in `src/player.c` and constants at the top of `src/scene.c`.
* **Model:** Replace `assets/models/coin.obj` with your own OBJ (ensure triangulated, single mesh).

---

## 8 · Troubleshooting

| Symptom                          | Cause / Fix                                                                                                              |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| White ground / sky on Intel iGPU | Ensure driver supports >GL 1.1. Ground loader uses **GL\_BGRA** formats; Intel’s legacy may need updated drivers.        |
| Texture appears tinted red       | Format mismatch between SDL surface and `glTexImage2D`. Keep **BGRA8888 ↔ GL\_BGRA** or **RGBA8888 ↔ GL\_RGBA** in sync. |
| `glGenerateMipmap` linking error | Windows’ `opengl32.dll` only exports GL 1.1. Either disable mipmap path or load the function pointer manually.           |
| Missing `assets/` at runtime     | The binary must run with `assets/` in the same folder. Otherwise, models/textures fail to load.                          |

---

## 9 · License

This project is released under the **MIT License**. See [LICENSE](LICENSE) for full details.

---

## 10 · Credits

* **SDL2** – [https://libsdl.org](https://libsdl.org)
* **SDL2\_image** – image decoding utilities
* **Ground Texture:** Generated by ChatGPT (GPT-4)
* **All code & remaining art © 2025 Baba Levente**

Enjoy coding and may your cube run forever!